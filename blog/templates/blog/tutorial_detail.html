{% extends "blog/base_with_nav.html"%}
{% load crispy_forms_tags %}
{% load static %}
{% block title %}
{{ tutorial.title }}
{% endblock %}
{% block content%}
    <br>
    <div class="tutorial-detail-main">
        <br>
        <div class="without-comment-like-button">
          {% if tutorial.image %}
          <div class="detail-tuto-image">
            <img src="{{ tutorial.image.url }}" alt="">
          </div>
          <br>
          {% endif %}
          <h1>{{ tutorial.title }}</h1>
          <br>
          <div class="tutorial-author">
            <img src="{{ tutorial.user.profile.profile_pic.url }}" alt="" style="width:60px;height:60px;border-radius:50%;">
            <div class="other-details">
              {% if tutorial.user == request.user %}
                <a href="{% url 'profile' tutorial.user.username %}">{{ tutorial.user.username}}</a>
              {% else %}
                <a href="{% url 'userprofilepost' tutorial.user.username %}">{{ tutorial.user.username}}</a>
              {% endif %}
             
              <br>
              <small class="text-muted">{{ tutorial.date_posted|date:"M, D Y"}}</small>
            </div>
          </div>
          <br>
          <span class="tuto-content">{{ tutorial.tutorial_content|safe }}</span>
          <br>
          <hr class="my-4">
          <br>
          <h3 class="mb-3">Suggested improvements about tutorial</h3>
          <br>
          <div class="for-suggested-improvements">
            <ul class="">
              {% for improvement in improvements %}
                <li class="">
                  <img src="{{ improvement.user.profile.profile_pic.url}}" alt="">
                  <div>
                    <a  class="text-muted" href="{{ improvement.get_absolut_improvement }}"> {{ improvement.title }}</a>
                    <br>
                    <span class="text-muted"><i class="fas fa-eye"></i> {{ improvement.views }}</span> |
                    <span class="text-muted">{{ improvement.date_posted }}</span>
                  </div>
                </li>
                <hr class="my-4">
              {% empty %}
                <li>No suggestions available for this tutorial</li>
              {% endfor %}
            </ul>
          </div>
        </div>
        <div id="like-helpful-section" >
          <div class="some-button">
            <div id="likes_section">
               {% include "blog/like_form.html" %}
             </div>
           <a title="comments" class="" href="#" data-toggle="modal" data-target="#sideModalTR"><i class="fas fa-comment text-muted"></i> <span class="text-muted">{{ comments.count }}</span></a>
  
           <a title="suggest improvements for this tutorial" class="" href="#" data-toggle="modal" data-target="#improvemntSideModal"><i class="fas fa-edit text-muted"></i> <span class="text-muted">{{ improvements.count }}</span></a>
           
          </div>
        </div>

    </div>
<br>

<!-- To change the direction of the modal animation change .right class -->
<div class="modal fade right" id="sideModalTR" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-side modal-top-right" role="document">

    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title w-100" id="myModalLabel">Comments</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="comments_section">
          {% include "blog/comment_form.html" %}
      </div>
    </div>
  </div>
</div>
<br>

<!-- tutorial improvement form -->
<div class="modal fade right" id="improvemntSideModal" tabindex="-1" role="dialog" aria-labelledby="improvementModal"
  aria-hidden="true">
  <div class="modal-dialog modal-side modal-top-right" role="document">

    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title w-100" id="improvementModal">Suggest Improvement</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="improvement_section" style="overflow:hidden;overflow-x: hidden;">
          <form method="POST" style="overflow-x: hidden;height:400px;overflow:scroll;">
            {% csrf_token %}
            <div class="form-group">
              {{ improvement_form|crispy }}
            </div>
            <div class="form-group">
              <button class="butt" type="submit">Save</button>
            </div>
          </form>
      </div>
    </div>
  </div>
</div>
<br>
<br>
{% endblock %}

